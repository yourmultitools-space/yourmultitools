<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Merge PDF - Your Multi Tools</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
/* Reuse your existing CSS variables and base styles */
:root {
  --primary: #4361ee;
  --primary-dark: #3a0ca3;
  --secondary: #4cc9f0;
  --accent: #f72585;
  --accent2: #ff6b35;
  --light: #f8f9fa;
  --dark: #0f172a;
  --darker: #0a0f1d;
  --gray: #6c757d;
  --light-gray: #e9ecef;
  --text-muted: rgba(255, 255, 255, 0.7);
  --body-bg: linear-gradient(135deg, var(--darker) 0%, var(--dark) 100%);
  --card-bg: rgba(15, 23, 42, 0.5);
  --card-header-bg: linear-gradient(135deg, rgba(67, 97, 238, 0.3) 0%, rgba(58, 12, 163, 0.3) 100%);
  --glass: rgba(255, 255, 255, 0.08);
  --glass-border: rgba(255, 255, 255, 0.18);
  --transition: all 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
  --shadow: 0 6px 20px rgba(0, 0, 0, 0.12);
  --shadow-hover: 0 12px 30px rgba(0, 0, 0, 0.18);
  --radius: 16px;
}

body.light-mode {
  --light: #0f172a;
  --dark: #f8f9fa;
  --darker: #ffffff;
  --gray: #495057;
  --light-gray: #dee2e6;
  --text-muted: rgba(15, 23, 42, 0.7);
  --body-bg: linear-gradient(135deg, var(--darker) 0%, var(--dark) 100%);
  --card-bg: rgba(255, 255, 255, 0.6);
  --card-header-bg: linear-gradient(135deg, rgba(67, 97, 238, 0.1) 0%, rgba(58, 12, 163, 0.1) 100%);
  --glass: rgba(0, 0, 0, 0.05);
  --glass-border: rgba(0, 0, 0, 0.1);
  --shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
  --shadow-hover: 0 12px 30px rgba(0, 0, 0, 0.12);
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Poppins', sans-serif;
  background: var(--body-bg);
  color: var(--light);
  line-height: 1.7;
  overflow-x: hidden;
  min-height: 100vh;
  position: relative;
  transition: background 0.4s ease, color 0.4s ease;
}

/* Header Styles */
header {
  background: rgba(15, 23, 42, 0.7);
  backdrop-filter: blur(12px);
  padding: 1.2rem 5%;
  position: sticky;
  top: 0;
  z-index: 1000;
  border-bottom: 1px solid var(--glass-border);
  transition: var(--transition);
}
body.light-mode header {
    background: rgba(255, 255, 255, 0.7);
}

.navbar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  max-width: 1400px;
  margin: 0 auto;
}

.logo {
  display: flex;
  align-items: center;
  font-size: 1.8rem;
  font-weight: 700;
  color: var(--light);
  text-decoration: none;
  font-family: 'Montserrat', sans-serif;
}

.logo i {
  margin-right: 12px;
  background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
  padding: 10px;
  border-radius: 12px;
  font-size: 1.4rem;
  color: white;
}

.nav-links {
  display: flex;
  align-items: center;
  gap: 2.5rem;
}

.nav-links a {
  color: var(--text-muted);
  text-decoration: none;
  font-weight: 500;
  transition: var(--transition);
  position: relative;
  font-size: 1.05rem;
}

.nav-links a:hover, .nav-links a.active {
  color: var(--light);
}

/* Theme Toggle Button */
#theme-toggle {
    background: var(--glass);
    border: 1px solid var(--glass-border);
    color: var(--light);
    width: 45px;
    height: 45px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2rem;
    transition: var(--transition);
}
#theme-toggle:hover {
    background: var(--primary);
    color: white;
}
#theme-toggle .fa-sun { display: none; }
body.light-mode #theme-toggle .fa-sun { display: block; }
body.light-mode #theme-toggle .fa-moon { display: none; }

/* Main Content Styles */
.main-content {
  max-width: 1200px;
  margin: 2rem auto;
  padding: 0 20px;
}

.tool-header {
  text-align: center;
  margin-bottom: 3rem;
}

.tool-header h1 {
  font-size: 2.8rem;
  margin-bottom: 1rem;
  background: linear-gradient(to right, var(--primary), var(--secondary), var(--accent));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  line-height: 1.15;
  letter-spacing: -0.5px;
}

.tool-header p {
  font-size: 1.2rem;
  color: var(--text-muted);
  max-width: 700px;
  margin: 0 auto;
}

.tool-container {
  display: flex;
  flex-direction: column;
  gap: 2rem;
}

.upload-section {
  background: var(--card-bg);
  border: 1px solid var(--glass-border);
  border-radius: var(--radius);
  padding: 2.5rem;
  text-align: center;
  backdrop-filter: blur(10px);
  transition: var(--transition);
  box-shadow: var(--shadow);
}

.upload-section:hover {
  box-shadow: var(--shadow-hover);
}

.drop-area {
  border: 2px dashed var(--glass-border);
  border-radius: var(--radius);
  padding: 3rem 2rem;
  cursor: pointer;
  transition: var(--transition);
  position: relative;
  overflow: hidden;
}

.drop-area:hover {
  border-color: var(--primary);
}

.drop-area.active {
  border-color: var(--accent);
  background: rgba(67, 97, 238, 0.05);
}

.drop-area i {
  font-size: 4rem;
  color: var(--primary);
  margin-bottom: 1.5rem;
  transition: var(--transition);
}

.drop-area h3 {
  font-size: 1.8rem;
  margin-bottom: 1rem;
}

.drop-area p {
  color: var(--text-muted);
  margin-bottom: 1.5rem;
}

.file-input {
  display: none;
}

.btn {
  background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
  color: white;
  border: none;
  padding: 1rem 2rem;
  border-radius: 50px;
  font-size: 1.1rem;
  font-weight: 600;
  cursor: pointer;
  transition: var(--transition);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  box-shadow: 0 4px 15px rgba(67, 97, 238, 0.3);
}

.btn:hover {
  transform: translateY(-3px);
  box-shadow: 0 8px 25px rgba(67, 97, 238, 0.4);
}

.btn i {
  font-size: 1.2rem;
}

.btn-outline {
  background: transparent;
  border: 2px solid var(--primary);
  color: var(--primary);
  box-shadow: none;
}

.btn-outline:hover {
  background: rgba(67, 97, 238, 0.1);
}

/* Files list styles */
.files-section {
  background: var(--card-bg);
  border: 1px solid var(--glass-border);
  border-radius: var(--radius);
  padding: 2rem;
  backdrop-filter: blur(10px);
  box-shadow: var(--shadow);
}

.files-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 1px solid var(--glass-border);
}

.files-header h2 {
  font-size: 1.5rem;
  font-weight: 600;
}

.files-list {
  list-style: none;
  margin-bottom: 2rem;
}

.file-item {
  display: flex;
  align-items: center;
  padding: 1rem;
  background: var(--glass);
  border-radius: 12px;
  margin-bottom: 1rem;
  transition: var(--transition);
}

.file-item:hover {
  background: rgba(67, 97, 238, 0.1);
}

.file-icon {
  width: 50px;
  height: 50px;
  background: rgba(67, 97, 238, 0.15);
  border-radius: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-right: 1.5rem;
  flex-shrink: 0;
}

.file-icon i {
  color: var(--primary);
  font-size: 1.5rem;
}

.file-info {
  flex-grow: 1;
  min-width: 0;
}

.file-name {
  font-weight: 500;
  margin-bottom: 0.3rem;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.file-size {
  color: var(--text-muted);
  font-size: 0.9rem;
}

.file-actions {
  display: flex;
  gap: 0.8rem;
}

.action-btn {
  width: 36px;
  height: 36px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--glass);
  color: var(--text-muted);
  border: 1px solid var(--glass-border);
  cursor: pointer;
  transition: var(--transition);
}

.action-btn:hover {
  background: var(--primary);
  color: white;
  border-color: var(--primary);
}

/* Result section */
.result-section {
  background: var(--card-bg);
  border: 1px solid var(--glass-border);
  border-radius: var(--radius);
  padding: 2rem;
  text-align: center;
  backdrop-filter: blur(10px);
  box-shadow: var(--shadow);
  display: none;
}

.result-section.active {
  display: block;
}

.result-icon {
  width: 80px;
  height: 80px;
  background: rgba(76, 201, 240, 0.15);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 0 auto 1.5rem;
}

.result-icon i {
  color: var(--secondary);
  font-size: 2.5rem;
}

.result-info h3 {
  font-size: 1.8rem;
  margin-bottom: 1rem;
}

.result-info p {
  color: var(--text-muted);
  margin-bottom: 1.5rem;
}

.result-actions {
  display: flex;
  justify-content: center;
  gap: 1rem;
  flex-wrap: wrap;
}

.file-preview {
  max-width: 100%;
  height: auto;
  border-radius: 12px;
  margin-top: 1.5rem;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
}

/* Footer */
footer {
  background: rgba(15, 23, 42, 0.9);
  color: var(--light);
  padding: 3rem 5% 2rem;
  margin-top: 4rem;
  border-top: 1px solid var(--glass-border);
}
body.light-mode footer {
    background: var(--darker);
    color: var(--light);
}

.footer-content {
  max-width: 1400px;
  margin: 0 auto;
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 2rem;
}

.footer-column h3 {
  font-size: 1.4rem;
  margin-bottom: 1.5rem;
  position: relative;
  padding-bottom: 0.8rem;
  font-weight: 600;
}

.footer-column h3::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  width: 50px;
  height: 3px;
  background: var(--accent);
}

.footer-links {
  list-style: none;
}

.footer-links li {
  margin-bottom: 1rem;
}

.footer-links a {
  text-decoration: none;
  transition: var(--transition);
  color: var(--text-muted);
  display: flex;
  align-items: center;
  gap: 0.8rem;
  font-weight: 300;
}

.footer-links a:hover {
  color: var(--secondary);
}

.footer-links a i {
  font-size: 0.8rem;
  color: var(--accent);
  transition: var(--transition);
}

.footer-links a:hover i {
  transform: translateX(3px);
}

.copyright {
  text-align: center;
  padding-top: 3rem;
  font-size: 0.95rem;
  max-width: 1400px;
  margin: 3rem auto 0;
  padding: 2rem 0 0;
  color: var(--text-muted);
  border-top: 1px solid var(--glass-border);
}

/* Loading spinner */
.spinner {
  display: inline-block;
  width: 20px;
  height: 20px;
  border: 3px solid rgba(255,255,255,.3);
  border-radius: 50%;
  border-top-color: white;
  animation: spin 1s ease-in-out infinite;
  margin-right: 10px;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

/* Responsive */
@media (max-width: 768px) {
  .tool-header h1 {
    font-size: 2.2rem;
  }
  
  .upload-section {
    padding: 1.5rem;
  }
  
  .drop-area {
    padding: 2rem 1rem;
  }
  
  .drop-area i {
    font-size: 3rem;
  }
  
  .drop-area h3 {
    font-size: 1.5rem;
  }
  
  .file-item {
    flex-direction: column;
    align-items: flex-start;
  }
  
  .file-icon {
    margin-right: 0;
    margin-bottom: 1rem;
  }
  
  .file-actions {
    margin-top: 1rem;
    width: 100%;
    justify-content: flex-end;
  }
  
  .result-actions {
    flex-direction: column;
    align-items: center;
  }
  
  .btn {
    width: 100%;
  }
}
</style>
</head>
<body>

<header>
    <nav class="navbar">
        <a href="#" class="logo">
            <i class="fas fa-tools"></i>
            yourmultitools.space
        </a>
        <div class="nav-links">
            <a href="#home">Home</a>
            <a href="#tools">Tools</a>
            <a href="#features">Features</a>
            <a href="#support">Support</a>
            <button id="theme-toggle" title="Toggle dark/light mode">
                <i class="fas fa-moon"></i>
                <i class="fas fa-sun"></i>
            </button>
        </div>
    </nav>
</header>

<div class="main-content">
    <div class="tool-header">
        <h1>Merge PDF Files</h1>
        <p>Combine multiple PDF documents into one unified file with our easy-to-use tool</p>
    </div>
    
    <div class="tool-container">
        <div class="upload-section">
            <div class="drop-area" id="dropArea">
                <i class="fas fa-file-pdf"></i>
                <h3>Drop your PDF files here</h3>
                <p>or click to browse files</p>
                <button class="btn" id="selectFilesBtn">
                    <i class="fas fa-folder-open"></i> Select Files
                </button>
                <input type="file" class="file-input" id="fileInput" accept=".pdf" multiple>
            </div>
        </div>
        
        <div class="files-section" id="filesSection" style="display: none;">
            <div class="files-header">
                <h2>Files to Merge</h2>
                <div class="file-count">0 files selected</div>
            </div>
            <ul class="files-list" id="filesList">
                <!-- Files will be listed here -->
            </ul>
            <div class="files-actions">
                <button class="btn" id="mergeBtn">
                    <i class="fas fa-object-group"></i> Merge PDFs
                </button>
                <button class="btn btn-outline" id="clearBtn">
                    <i class="fas fa-trash-alt"></i> Clear All
                </button>
            </div>
        </div>
        
        <div class="result-section" id="resultSection">
            <div class="result-icon">
                <i class="fas fa-check-circle"></i>
            </div>
            <div class="result-info">
                <h3>PDFs Merged Successfully!</h3>
                <p>Your combined PDF file is ready for download</p>
                <div class="result-actions">
                    <button class="btn" id="downloadBtn">
                        <i class="fas fa-download"></i> Download Merged PDF
                    </button>
                    <button class="btn btn-outline" id="newMergeBtn">
                        <i class="fas fa-redo"></i> Merge Another
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<footer id="support">
    <div class="footer-content">
        <div class="footer-column">
            <h3>Your Multi Tools</h3>
            <p style="color: var(--text-muted); margin-bottom: 1.8rem;">Premium solutions for professionals and businesses worldwide.</p>
            <div style="display: flex; gap: 1.2rem;">
                <a href="https://facebook.com/yourmultitools" target="_blank" rel="noopener noreferrer" style="font-size: 1.3rem; color: rgba(255, 255, 255, 0.6);"><i class="fab fa-facebook"></i></a>
                <a href="https://twitter.com/yourmultitools" target="_blank" rel="noopener noreferrer" style="font-size: 1.3rem; color: rgba(255, 255, 255, 0.6);"><i class="fab fa-twitter"></i></a>
                <a href="https://instagram.com/yourmultitools" target="_blank" rel="noopener noreferrer" style="font-size: 1.3rem; color: rgba(255, 255, 255, 0.6);"><i class="fab fa-instagram"></i></a>
                <a href="https://linkedin.com/company/yourmultitools" target="_blank" rel="noopener noreferrer" style="font-size: 1.3rem; color: rgba(255, 255, 255, 0.6);"><i class="fab fa-linkedin"></i></a>
            </div>
        </div>
        <div class="footer-column">
            <h3>Quick Links</h3>
            <ul class="footer-links">
                <li><a href="#"><i class="fas fa-chevron-right"></i> Home</a></li>
                <li><a href="#"><i class="fas fa-chevron-right"></i> PDF Tools</a></li>
                <li><a href="#"><i class="fas fa-chevron-right"></i> Audio & Video Tools</a></li>
                <li><a href="#"><i class="fas fa-chevron-right"></i> Features</a></li>
            </ul>
        </div>
        <div class="footer-column">
            <h3>Popular Tools</h3>
            <ul class="footer-links">
                <li><a href="#"><i class="fas fa-chevron-right"></i> PDF Compressor</a></li>
                <li><a href="#"><i class="fas fa-chevron-right"></i> Video Compressor</a></li>
                <li><a href="#"><i class="fas fa-chevron-right"></i> Audio Compressor</a></li>
                <li><a href="#"><i class="fas fa-chevron-right"></i> File Converter</a></li>
            </ul>
        </div>
        <div class="footer-column">
            <h3>Contact Us</h3>
            <ul class="footer-links">
                <li><a href="mailto:yourmultitools.space@gmail.com"><i class="fas fa-envelope"></i> yourmultitools.space@gmail.com</a></li>
                <li><a href="#"><i class="fas fa-map-marker-alt"></i> India</a></li>
                <li><a href="#"><i class="fas fa-file-contract"></i> Terms and Conditions</a></li>
                <li><a href="#"><i class="fas fa-lock"></i> Privacy Policy</a></li>
            </ul>
        </div>
    </div>
    <div class="copyright">
        <p>© <span id="copyright-year"></span> yourmultitools.space. All rights reserved. | Premium Solutions for Professionals</p>
    </div>
</footer>

<script>
// PDF-LIB library for PDF manipulation
const pdfLibScript = document.createElement('script');
pdfLibScript.src = 'https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js';
document.head.appendChild(pdfLibScript);

// Theme toggle functionality
document.addEventListener('DOMContentLoaded', function() {
    // Theme toggle
    const themeToggle = document.getElementById('theme-toggle');
    const body = document.body;
    
    themeToggle.addEventListener('click', () => {
        body.classList.toggle('light-mode');
        localStorage.setItem('theme', body.classList.contains('light-mode') ? 'light' : 'dark');
    });
    
    // Set initial theme
    if (localStorage.getItem('theme') === 'light') {
        body.classList.add('light-mode');
    }
    
    // Set copyright year
    document.getElementById('copyright-year').textContent = new Date().getFullYear();
    
    // PDF merge functionality
    const dropArea = document.getElementById('dropArea');
    const fileInput = document.getElementById('fileInput');
    const selectFilesBtn = document.getElementById('selectFilesBtn');
    const filesSection = document.getElementById('filesSection');
    const filesList = document.getElementById('filesList');
    const fileCount = document.querySelector('.file-count');
    const mergeBtn = document.getElementById('mergeBtn');
    const clearBtn = document.getElementById('clearBtn');
    const resultSection = document.getElementById('resultSection');
    const downloadBtn = document.getElementById('downloadBtn');
    const newMergeBtn = document.getElementById('newMergeBtn');
    
    let files = [];
    
    // Open file dialog when button is clicked
    selectFilesBtn.addEventListener('click', () => {
        fileInput.click();
    });
    
    // Handle file selection
    fileInput.addEventListener('change', handleFileSelect);
    
    // Drag and drop functionality
    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
        dropArea.addEventListener(eventName, preventDefaults, false);
    });
    
    function preventDefaults(e) {
        e.preventDefault();
        e.stopPropagation();
    }
    
    ['dragenter', 'dragover'].forEach(eventName => {
        dropArea.addEventListener(eventName, highlight, false);
    });
    
    ['dragleave', 'drop'].forEach(eventName => {
        dropArea.addEventListener(eventName, unhighlight, false);
    });
    
    function highlight() {
        dropArea.classList.add('active');
    }
    
    function unhighlight() {
        dropArea.classList.remove('active');
    }
    
    // Handle file drop
    dropArea.addEventListener('drop', handleDrop, false);
    
    function handleDrop(e) {
        const dt = e.dataTransfer;
        const newFiles = dt.files;
        handleFiles(newFiles);
    }
    
    function handleFileSelect(e) {
        const newFiles = e.target.files;
        handleFiles(newFiles);
    }
    
    function handleFiles(newFiles) {
        for (let i = 0; i < newFiles.length; i++) {
            const file = newFiles[i];
            if (file.type === 'application/pdf') {
                files.push(file);
            }
        }
        updateFileList();
    }
    
    function updateFileList() {
        if (files.length > 0) {
            filesSection.style.display = 'block';
            fileCount.textContent = `${files.length} file${files.length > 1 ? 's' : ''} selected`;
            
            // Clear existing list
            filesList.innerHTML = '';
            
            // Add files to list
            files.forEach((file, index) => {
                const listItem = document.createElement('li');
                listItem.className = 'file-item';
                listItem.innerHTML = `
                    <div class="file-icon">
                        <i class="fas fa-file-pdf"></i>
                    </div>
                    <div class="file-info">
                        <div class="file-name">${file.name}</div>
                        <div class="file-size">${formatFileSize(file.size)}</div>
                    </div>
                    <div class="file-actions">
                        <button class="action-btn move-up" data-index="${index}" ${index === 0 ? 'disabled' : ''}>
                            <i class="fas fa-arrow-up"></i>
                        </button>
                        <button class="action-btn move-down" data-index="${index}" ${index === files.length - 1 ? 'disabled' : ''}>
                            <i class="fas fa-arrow-down"></i>
                        </button>
                        <button class="action-btn remove-file" data-index="${index}">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                `;
                filesList.appendChild(listItem);
            });
            
            // Add event listeners for file actions
            document.querySelectorAll('.move-up').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const index = parseInt(e.target.closest('button').dataset.index);
                    moveFileUp(index);
                });
            });
            
            document.querySelectorAll('.move-down').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const index = parseInt(e.target.closest('button').dataset.index);
                    moveFileDown(index);
                });
            });
            
            document.querySelectorAll('.remove-file').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const index = parseInt(e.target.closest('button').dataset.index);
                    removeFile(index);
                });
            });
        } else {
            filesSection.style.display = 'none';
        }
    }
    
    function moveFileUp(index) {
        if (index > 0) {
            const temp = files[index];
            files[index] = files[index - 1];
            files[index - 1] = temp;
            updateFileList();
        }
    }
    
    function moveFileDown(index) {
        if (index < files.length - 1) {
            const temp = files[index];
            files[index] = files[index + 1];
            files[index + 1] = temp;
            updateFileList();
        }
    }
    
    function removeFile(index) {
        files.splice(index, 1);
        updateFileList();
    }
    
    function formatFileSize(bytes) {
        if (bytes === 0) return '0 Bytes';
        const k = 1024;
        const sizes = ['Bytes', 'KB', 'MB', 'GB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    }
    
    // Clear all files
    clearBtn.addEventListener('click', () => {
        files = [];
        updateFileList();
    });
    
    // Merge PDFs
    mergeBtn.addEventListener('click', async () => {
        if (files.length < 2) {
            alert('Please select at least 2 PDF files to merge');
            return;
        }
        
        // Show loading state
        mergeBtn.innerHTML = '<span class="spinner"></span> Merging PDFs...';
        mergeBtn.disabled = true;
        
        try {
            // Wait for pdf-lib to load
            if (typeof PDFLib === 'undefined') {
                await new Promise(resolve => {
                    const checkLib = setInterval(() => {
                        if (typeof PDFLib !== 'undefined') {
                            clearInterval(checkLib);
                            resolve();
                        }
                    }, 100);
                });
            }
            
            const { PDFDocument } = PDFLib;
            const mergedPdf = await PDFDocument.create();
            
            // Merge all PDFs in order
            for (const file of files) {
                const fileData = await readFileAsArrayBuffer(file);
                const pdf = await PDFDocument.load(fileData);
                const pages = await mergedPdf.copyPages(pdf, pdf.getPageIndices());
                pages.forEach(page => mergedPdf.addPage(page));
            }
            
            // Generate merged PDF
            const mergedPdfBytes = await mergedPdf.save();
            
            // Create download link
            const blob = new Blob([mergedPdfBytes], { type: 'application/pdf' });
            const url = URL.createObjectURL(blob);
            
            // Set download link
            downloadBtn.onclick = () => {
                const a = document.createElement('a');
                a.href = url;
                a.download = 'merged-document.pdf';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
            };
            
            // Show result section
            resultSection.classList.add('active');
            filesSection.style.display = 'none';
            dropArea.style.display = 'none';
            
        } catch (error) {
            console.error('Error merging PDFs:', error);
            alert('An error occurred while merging the PDF files. Please try again.');
        } finally {
            // Reset button
            mergeBtn.innerHTML = '<i class="fas fa-object-group"></i> Merge PDFs';
            mergeBtn.disabled = false;
        }
    });
    
    // Helper function to read file as ArrayBuffer
    function readFileAsArrayBuffer(file) {
        return new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.onload = () => resolve(reader.result);
            reader.onerror = reject;
            reader.readAsArrayBuffer(file);
        });
    }
    
    // Start new merge
    newMergeBtn.addEventListener('click', () => {
        files = [];
        resultSection.classList.remove('active');
        filesSection.style.display = 'none';
        dropArea.style.display = 'block';
    });
});

</script>
</body>
</html>
